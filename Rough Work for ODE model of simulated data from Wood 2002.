## recruitment function (Gaussian function)

R1 <- function( t, r_floor, r_height, r_ctr, r_scale) {
  r_floor+r_height*exp(-((t-r_ctr)/r_scale)^2)
}


## stage duration(negative exponential random variable) 
n <- rnbinom(12,5, 0.5)

## subsidiary variable 

v<- rep(NA, 12) 
for (i in 1:12) {
  v[i]<- 1/n[i] 
}

##death rate
delta<-function(t, d0) {
  d0
}

## recursion for recruitment function 
r <- function(i,...) {
  if (i ==1) return (R1(...))
  value<- v[i-1]*n[i-1]
  return(value)
}

##parms( what else gets included here)
parms<-c(r_floor=0, r_height=1, r_ctr=0, r_scale=1, size=1, prob =0.5, d0=1)


  
  with(as.list(c(parms))  {
    grad <- rep(NA_real_, 12) 
    r <- rep(NA_real_, 12)
    r[1] <- R1(t, r_floor, r_height, r_ctr, r_scale)
    grad[1]<- r[1]-r[2]-delta*r[2]
    for (i in 2:12) {
      grad[i]<- r[i]-r[i+1]-delta*r[i+1]
    }
  })
